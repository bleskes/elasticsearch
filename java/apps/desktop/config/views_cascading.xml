<?xml version="1.0" encoding="UTF-8"?>

<prelertViews>

	<!-- Evidence Lists -->
	
	<listView viewClass="com.prelert.data.EvidenceView">
		<name>Evidence View</name>
		<styleId>list-sec</styleId>
		<timeFrame>SECOND</timeFrame>
		<dbView>evidence_second_view</dbView>
		<filterableAttributes>
			<attributeName>description</attributeName>
			<attributeName>ipaddress</attributeName>
			<attributeName>service</attributeName>
			<attributeName>severity</attributeName>
			<attributeName>source</attributeName>
			<attributeName>username</attributeName>
		</filterableAttributes>
		<doubleClickTool>Show Info</doubleClickTool>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.UsageViewTool">
				<name>Show User Usage</name>
				<viewToOpen>User Usage</viewToOpen>
				<metric>total</metric>
				<timeFrame>HOUR</timeFrame>
				<sourceArg>source</sourceArg>
				<userArg>username</userArg>
				<timeArg>time</timeArg>
			</menuItem>
			<menuItem toolClass="com.prelert.data.UsageViewTool">
				<name>Show Service Usage</name>
				<viewToOpen>Service Usage</viewToOpen>
				<metric>serverload</metric>
				<timeFrame>HOUR</timeFrame>
				<sourceArg>source</sourceArg>
				<userArg>service</userArg>
				<timeArg>time</timeArg>
			</menuItem>
			<menuItem toolClass="com.prelert.data.UsageViewTool">
				<name>Show IPC Usage</name>
				<viewToOpen>IPC Usage</viewToOpen>
				<metric>inbound</metric>
				<timeFrame>HOUR</timeFrame>
				<sourceArg>source</sourceArg>
				<timeArg>time</timeArg>
			</menuItem>
			<menuItem toolClass="com.prelert.data.ShowInfoTool">
				<name>Show Info</name>
				<activeAttribute>appid</activeAttribute>
				<activeAttribute>description</activeAttribute>
				<activeAttribute>ipaddress</activeAttribute>
				<activeAttribute>node</activeAttribute>
				<activeAttribute>probable_cause</activeAttribute>
				<activeAttribute>service</activeAttribute>
				<activeAttribute>source</activeAttribute>
				<activeAttribute>username</activeAttribute>
			</menuItem>
		</contextMenu>
	</listView>
	
	<listView viewClass="com.prelert.data.ListView">
		<name>Weekly Evidence</name>
		<styleId>list-week</styleId>
		<dbView>evidence_week_view</dbView>
		<doubleClickTool>Show By Day</doubleClickTool>
		<defaultOrderBy>
			<sortInfo>
				<columnName>last_occurred</columnName>
				<sortDirection>DESC</sortDirection>
			</sortInfo>
		</defaultOrderBy>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show By Day</name>
				<viewToOpen>Evidence By Day</viewToOpen>
				<filterAttribute>description</filterAttribute>
				<filterArg>description</filterArg>
			</menuItem>
		</contextMenu>
	</listView>
	
	<listView viewClass="com.prelert.data.EvidenceView">
		<name>Evidence By Day</name>
		<styleId>list-day</styleId>
		<timeFrame>DAY</timeFrame>
		<dbView>evidence_day_view</dbView>
		<doubleClickTool>Show By Hour</doubleClickTool>
		<defaultOrderBy>
			<sortInfo>
				<columnName>day</columnName>
				<sortDirection>DESC</sortDirection>
			</sortInfo>
		</defaultOrderBy>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show By Hour</name>
				<viewToOpen>Evidence By Hour</viewToOpen>
				<filterAttribute>description</filterAttribute>
				<filterArg>description</filterArg>
			</menuItem>
		</contextMenu>
	</listView>
	
	<listView viewClass="com.prelert.data.EvidenceView">
		<name>Evidence By Hour</name>
		<styleId>list-hour</styleId>
		<timeFrame>HOUR</timeFrame>
		<dbView>evidence_hour_view</dbView>
		<doubleClickTool>Show By Minute</doubleClickTool>
		<defaultOrderBy>
			<sortInfo>
				<columnName>hour</columnName>
				<sortDirection>DESC</sortDirection>
			</sortInfo>
		</defaultOrderBy>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show By Minute</name>
				<viewToOpen>Evidence By Minute</viewToOpen>
				<filterAttribute>description</filterAttribute>
				<filterArg>description</filterArg>
			</menuItem>
		</contextMenu>
	</listView>
	
	<listView viewClass="com.prelert.data.EvidenceView">
		<name>Evidence By Minute</name>
		<styleId>list-min</styleId>
		<timeFrame>MINUTE</timeFrame>
		<dbView>evidence_minute_view</dbView>
		<doubleClickTool>Show By Second</doubleClickTool>
		<defaultOrderBy>
			<sortInfo>
				<columnName>minute</columnName>
				<sortDirection>DESC</sortDirection>
			</sortInfo>
		</defaultOrderBy>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show By Second</name>
				<viewToOpen>Evidence View</viewToOpen>
			</menuItem>
		</contextMenu>
	</listView>
	
	
	<!-- Probable Cause View  -->
	<listView viewClass="com.prelert.data.ListView">
		<name>Probable Causes</name>  <!-- IMPORTANT: this name is used as a key when opening Probable Cause views  -->
		<styleId>prob-cause</styleId>
		<dbView>probable_cause_view</dbView>
		<doubleClickTool>Show Info</doubleClickTool>
		<defaultOrderBy>
			<sortInfo>
				<columnName>last_occurred</columnName>
				<sortDirection>DESC</sortDirection>
			</sortInfo>
		</defaultOrderBy>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show Evidence</name>
				<viewToOpen>Evidence View</viewToOpen>
				<filterAttribute>probable_cause</filterAttribute>
				<filterArg>id</filterArg>
			</menuItem>
			<menuItem toolClass="com.prelert.data.ShowInfoTool">
				<name>Show Info</name>
			</menuItem>
		</contextMenu>
	</listView>
	
	<!-- Usage Charts  -->
	<usageView>
		<name>User Usage</name>
		<styleId>line-graph</styleId>
		<serviceId>Users</serviceId>
		<metrics>
			<metricName>total</metricName>
		</metrics>
		<labels>
			<sourceField>Source</sourceField>
			<allSources>All Sources</allSources>
			<selectSource>Select source...</selectSource>
			<userField>User</userField>
			<allUsers>All Users</allUsers>
			<selectUser>Select user...</selectUser>
		</labels>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show Evidence</name>
				<viewToOpen>Evidence View</viewToOpen>
			</menuItem>
		</contextMenu>
	</usageView>
	
	<usageView>
		<name>Service Usage</name>
		<styleId>line-graph</styleId>
		<serviceId>Services</serviceId>
		<metrics>
			<metricName>active</metricName>
			<metricName>pending</metricName>
			<metricName>pendingOut</metricName>
			<metricName>serverload</metricName>
		</metrics>
		<labels>
			<sourceField>Source</sourceField>
			<allSources>All Sources</allSources>
			<selectSource>Select source...</selectSource>
			<userField>Service</userField>
			<allUsers>All Services</allUsers>
			<selectUser>Select service...</selectUser>
		</labels>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show Evidence</name>
				<viewToOpen>Evidence View</viewToOpen>
			</menuItem>
		</contextMenu>
	</usageView>
	
	<usageView>
		<name>IPC Usage</name>
		<styleId>line-graph</styleId>
		<serviceId>IPC</serviceId>
		<metrics>
			<metricName>inbound</metricName>
			<metricName>outbound</metricName>
		</metrics>
		<labels>
			<sourceField>Source</sourceField>
			<allSources>All Sources</allSources>
			<selectSource>Select source...</selectSource>
		</labels>
		<contextMenu>
			<menuItem toolClass="com.prelert.data.ListViewTool">
				<name>Show Evidence</name>
				<viewToOpen>Evidence View</viewToOpen>
			</menuItem>
		</contextMenu>
	</usageView>
	

</prelertViews>